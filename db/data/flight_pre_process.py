import pandas as pd
from io import StringIO

# Full dataset as provided by user
full_data = """Date,Airline,flight number,Departure city,Departure time,Arrival city,Arrival time,Millage
2026-01-06,荷兰皇家航空,KL1432,里昂圣修伯利,14:10,阿姆斯特丹史基浦,15:50,733km
2026-01-06,荷兰皇家航空,KL933,阿姆斯特丹史基浦,22:40,爱丁堡,23:10,667km
2025-12-27,易捷航空,U23248,爱丁堡,07:00,格勒诺布尔,10:25,1326km
2025-12-06,英国瑞安航空,RK597,爱丁堡,08:40,伦敦斯坦德,10:05,510km
2025-11-25,英国瑞安航空,RK9817,伦敦斯坦德,19:50,爱丁堡,21:15,510km
2025-06-20,海南航空,HU407,北京首都,03:10,爱丁堡,07:00,7944km
2025-06-19,海南航空,HU7612,上海虹桥,20:15,北京首都,22:30,1178km
2025-06-18,深圳航空,ZH9519,深圳宝安,14:30,上海浦东,17:05,1343km
2025-05-31,海南航空,HU408,爱丁堡,12:00,北京首都,05:10,7945km
2025-03-22,易捷航空,U23296,日内瓦,20:50,爱丁堡,22:10,1264km
2025-03-15,英国维兹航空,W95417,伦敦卢登,05:40,格勒诺布尔,08:50,837km
2025-01-04,易捷航空,U23296,日内瓦,20:50,爱丁堡,22:10,1264km
2024-12-28,易捷航空,U23293,爱丁堡,11:55,日内瓦,15:10,1264km
2024-09-15,欧洲之翼,EW362,科隆,13:55,爱丁堡,14:40,894km
2024-09-11,汉莎航空,LH1527,爱丁堡,05:55,法兰克福,08:50,1033km
2024-07-21,英国瑞安航空,RK1273,伦敦斯坦德,21:25,爱丁堡,22:45,510km
2024-07-20,英国瑞安航空,RK597,爱丁堡,06:40,伦敦斯坦德,08:00,510km
2024-07-07,瑞安航空,FR5590,罗马洽米皮诺,11:45,爱丁堡,14:00,1950km
2024-07-04,瑞安航空,FR4903,巴勒莫,14:45,罗马菲乌米奇诺,16:00,407km
2024-06-29,瑞安航空,FR3425,爱丁堡,05:45,巴勒莫,10:10,2325km
2024-05-05,易捷航空,U2336,伯明翰,21:00,爱丁堡,22:05,403km
2024-05-04,易捷航空,U2331,爱丁堡,07:00,伯明翰,08:15,403km
2024-04-13,易捷航空,U23294,日内瓦,20:45,爱丁堡,22:00,1264km
2024-04-06,瑞士易捷航空,DS1588,爱丁堡,09:05,日内瓦,12:35,1265km
2023-12-25,法国航空,AF1164,巴黎戴高乐,09:50,伯明翰,10:10,494km
2023-12-24,法国航空,AF111,上海浦东,22:15,巴黎戴高乐,06:00,9277km
2023-12-08,阿联酋航空,EK302,迪拜国际,03:10,上海浦东,15:05,6445km
2023-12-07,阿联酋航空,EK40,伯明翰,13:40,迪拜国际,00:45,5611km
2023-11-21,法国航空,AF1564,巴黎戴高乐,21:25,伯明翰,21:45,494km
2023-11-18,法国航空,AF1565,伯明翰,06:00,巴黎戴高乐,08:20,494km
2023-10-10,汉莎航空,LH958,法兰克福,21:55,伯明翰,22:30,767km
2023-10-07,汉莎航空,LH959,伯明翰,06:00,法兰克福,08:30,767km
2023-07-12,瑞安航空,FR3800,巴塞罗那埃尔普拉特,06:25,伯明翰,07:50,1272km
2023-07-06,瑞安航空,FR3801,伯明翰,06:30,巴塞罗那埃尔普拉特,09:45,1272km
2023-05-15,深圳航空,ZH9067,深圳宝安,12:00,伦敦希思罗,18:15,9604km
2023-05-14,深圳航空,ZH9512,上海浦东,17:30,深圳宝安,20:10,1343km
2023-05-01,深圳航空,ZH9527,深圳宝安,16:00,上海浦东,18:15,1234km
2023-04-29,深圳航空,ZH9068,伦敦希思罗,22:05,深圳宝安,17:45,9611km
2023-03-12,法国航空,AF1314,巴黎戴高乐,13:35,伯明翰,13:55,494km
2023-03-12,法国航空,AF7641,里昂圣修伯利,10:30,巴黎戴高乐,11:45,408km
2023-03-04,法国航空,AF1842,巴黎戴高乐,10:05,日内瓦,11:15,402km
2023-03-04,法国航空,AF1565,伯明翰,06:00,巴黎戴高乐,08:20,494km
2021-09-18,新加坡航空,SQ322,新加坡樟宜,23:30,伦敦希思罗,05:55,10893km
2021-09-18,新加坡航空,SQ883,香港国际,14:25,新加坡樟宜,18:20,2565km
2021-09-15,南方航空,CZ6848,黄山屯溪,11:00,深圳宝安,12:55,1038km
2021-03-02,南方航空,CZ6997,乌鲁木齐地窝堡,15:30,上海虹桥,20:20,3649km
2021-03-02,南方航空,CZ6842,阿勒泰雪都,11:20,乌鲁木齐地窝堡,12:35,450km
2021-02-22,南方航空,CZ6841,乌鲁木齐地窝堡,09:10,阿勒泰雪都,10:35,450km
2021-02-18,首都航空,JD5843,杭州萧山,06:55,乌鲁木齐地窝堡,12:30,3653km
2021-01-01,春秋航空,9C8936,长春龙嘉,19:30,上海浦东,22:15,1698km
2020-12-29,中国国航,CA1985,上海浦东,07:35,长春龙嘉,10:35,1698km
2020-12-11,中国国航,CA1854,宁波栎社,09:35,北京首都,12:00,1338km
2020-08-08,上海航空,FM9126,日照山字河,18:00,上海浦东,19:35,527km
2020-08-06,春秋航空,9C6537,上海虹桥,19:05,日照山字河,20:35,498km
2019-09-15,东方航空,MU212,马尼拉尼诺伊阿基诺,06:10,上海浦东,09:30,1853km
2019-09-14,菲律宾亚航,Z2353,薄荷岛,16:00,马尼拉尼诺伊阿基诺,17:30,622km
2019-09-11,菲律宾亚航,Z2354,马尼拉尼诺伊阿基诺,11:10,薄荷岛,12:35,622km
2019-09-11,菲律宾亚航,Z219,上海浦东,03:40,马尼拉尼诺伊阿基诺,07:15,1853km
2019-04-15,东方航空,MU288,冲绳那霸,17:40,上海浦东,18:45,811km
2019-04-12,东方航空,MU2085,上海浦东,09:55,冲绳那霸,13:30,792km
2018-10-04,东方航空,MU9268,黄山屯溪,--,上海虹桥,--,380km
2018-04-06,乐桃航空,MM79,大阪关西,22:10,上海浦东,00:05,1337km
2018-03-31,深圳航空,ZH9061,南通兴东,13:10,大阪关西,16:20,1352km
2018-03-31,乐桃航空,MM80,上海浦东,--,大阪关西,--,1308km
2017-10-07,新加坡航空,SQ828,新加坡樟宜,08:05,上海浦东,13:25,3809km
2017-10-06,新加坡航空,SQ451,马累维拉纳国际,23:25,新加坡樟宜,07:10,3398km
2017-10-01,新加坡航空,SQ462,新加坡樟宜,10:10,马累维拉纳国际,14:35,3398km
2017-10-01,新加坡航空,SQ825,上海浦东,00:35,新加坡樟宜,05:55,3796km
2017-08-02,乐桃航空,MM899,东京羽田,02:50,上海浦东,05:05,1739km
2017-07-29,乐桃航空,MM898,上海浦东,--,东京羽田,--,1787km
2017-01-31,东方航空,MU9268,黄山屯溪,22:30,上海虹桥,23:40,380km
2016-10-06,东方航空,MU260,圣彼得堡普尔科夫,23:05,上海浦东,13:30,7121km
2016-09-30,东方航空,MU591,上海浦东,11:55,莫斯科谢列梅捷沃,17:00,6828km
2016-04-18,厦门航空,MF8545,厦门高崎,19:00,上海虹桥,20:45,878km
2016-04-15,厦门航空,MF8568,上海虹桥,13:15,厦门高崎,15:05,878km
2015-06-30,中国国航,CA4535,成都双流,16:50,上海浦东,19:45,1782km
2015-06-26,吉祥航空,HO1269,上海虹桥,06:45,成都双流,10:40,1782km
2015-05-22,东方航空,MU524,东京成田,13:50,上海浦东,16:15,1787km
2015-05-17,东方航空,MU225,上海浦东,08:55,大阪关西,12:10,1337km"""

# Airline translations
airline_map = {
    "荷兰皇家航空": "KLM Royal Dutch Airlines",
    "易捷航空": "easyJet",
    "英国瑞安航空": "Ryanair",
    "海南航空": "Hainan Airlines",
    "深圳航空": "Shenzhen Airlines",
    "英国维兹航空": "Wizz Air UK",
    "欧洲之翼": "Eurowings",
    "汉莎航空": "Lufthansa",
    "瑞安航空": "Ryanair",
    "瑞士易捷航空": "Swiss easyJet",
    "法国航空": "Air France",
    "阿联酋航空": "Emirates",
    "新加坡航空": "Singapore Airlines"
}

# Airport translations and IATA codes
airport_map = {
    "里昂圣修伯利": ("Lyon Saint-Exupéry","LYS"),
    "阿姆斯特丹史基浦": ("Amsterdam Schiphol","AMS"),
    "爱丁堡": ("Edinburgh","EDI"),
    "格勒诺布尔": ("Grenoble","GNB"),
    "伦敦斯坦德": ("London Stansted","STN"),
    "北京首都": ("Beijing Capital","PEK"),
    "上海虹桥": ("Shanghai Hongqiao","SHA"),
    "上海浦东": ("Shanghai Pudong","PVG"),
    "深圳宝安": ("Shenzhen Bao'an","SZX"),
    "日内瓦": ("Geneva","GVA"),
    "伦敦卢登": ("London Luton","LTN"),
    "科隆": ("Cologne","CGN"),
    "法兰克福": ("Frankfurt","FRA"),
    "巴黎戴高乐": ("Paris Charles de Gaulle","CDG"),
    "迪拜国际": ("Dubai International","DXB"),
    "巴塞罗那埃尔普拉特": ("Barcelona El Prat","BCN"),
    "伦敦希思罗": ("London Heathrow","LHR"),
    "新加坡樟宜": ("Singapore Changi","SIN"),
    "香港国际": ("Hong Kong International","HKG"),
    "罗马洽米皮诺": ("Rome Ciampino", "CIA"),
    "巴勒莫": ("Palermo", "PMO"),
    "伯明翰": ("Birmingham", "BHX"),
    "黄山屯溪": ("Huangshan Tunxi", "TXN"),
    "乌鲁木齐地窝堡": ("Urumqi Diwopu", "URC"),
    "阿勒泰雪都": ("Altay Xuedu", "AAT"),
    "杭州萧山": ("Hangzhou Xiaoshan", "HGH"),
    "长春龙嘉": ("Changchun Longjia", "CGQ"),
    "宁波栎社": ("Ningbo Lishe", "NGB"),
    "日照山字河": ("Rizhao Shanzihe", "RIZ"),
    "马尼拉尼诺伊阿基诺": ("Manila Ninoy Aquino", "MNL"),
    "薄荷岛": ("Bohol", "TAGB"),
    "冲绳那霸": ("Okinawa Naha", "OKA"),
    "大阪关西": ("Osaka Kansai", "KIX"),
    "南通兴东": ("Nantong Xingdong", "NTG"),
    "马累维拉纳国际": ("Male Velana International", "MLE"),
    "东京羽田": ("Tokyo Haneda", "HND"),
    "圣彼得堡普尔科夫": ("St. Petersburg Pulkovo", "LED"),
    "厦门高崎": ("Xiamen Gaoqi", "XMN"),
    "成都双流": ("Chengdu Shuangliu", "CTU"),
    "东京成田": ("Tokyo Narita", "NRT"),
    "莫斯科谢列梅捷沃": ("Moscow Sheremetyevo", "SVO"),
    "罗马菲乌米奇诺": ("Rome Fiumicino", "FCO"),
}

# Load data
df = pd.read_csv(StringIO(full_data))

# Translate airlines
df['Airline'] = df['Airline'].map(lambda x: airline_map.get(x,x))

# Translate airports and add IATA columns
df['Departure IATA'] = df['Departure city'].map(lambda x: airport_map.get(x,(x,""))[1])
df['Arrival IATA'] = df['Arrival city'].map(lambda x: airport_map.get(x,(x,""))[1])
df['Departure city'] = df['Departure city'].map(lambda x: airport_map.get(x,(x,""))[0])
df['Arrival city'] = df['Arrival city'].map(lambda x: airport_map.get(x,(x,""))[0])

# Convert mileage to numbers
df['Millage'] = df['Millage'].str.replace('km','').replace('--','0').astype(int)

# Reorder columns
df = df[['Date','Airline','flight number','Departure city','Departure IATA','Departure time',
         'Arrival city','Arrival IATA','Arrival time','Millage']]

# Output as CSV text
csv_text = df.to_csv(index=False)
print(csv_text)